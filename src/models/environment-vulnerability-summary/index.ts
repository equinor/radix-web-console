import * as PropTypes from 'prop-types';

import {
  VulnerabilitySummaryModel,
  VulnerabilitySummaryModelValidationMap,
} from '../vulnerability-summary';

export interface EnvironmentVulnerabilityObjectModel {
  lastScanned: Date;
  vulnerabilitySummary?: VulnerabilitySummaryModel;
}

export interface EnvironmentVulnerabilitySummaryModel {
  components?: { [key: string]: EnvironmentVulnerabilityObjectModel };
  jobs?: { [key: string]: EnvironmentVulnerabilityObjectModel };
}

/* PropTypes validation map for EnvironmentVulnerabilityObjectModel */
export const EnvironmentVulnerabilityObjectModelValidationMap: PropTypes.ValidationMap<EnvironmentVulnerabilityObjectModel> =
  {
    lastScanned: PropTypes.instanceOf(Date).isRequired,
    vulnerabilitySummary: PropTypes.shape(
      VulnerabilitySummaryModelValidationMap
    ),
  };

/* PropTypes validation map for EnvironmentVulnerabilitySummaryModel */
export const EnvironmentVulnerabilitySummaryModelValidationMap: PropTypes.ValidationMap<EnvironmentVulnerabilitySummaryModel> =
  {
    components: PropTypes.objectOf<EnvironmentVulnerabilityObjectModel>(
      PropTypes.shape(
        EnvironmentVulnerabilityObjectModelValidationMap
      ) as PropTypes.Requireable<EnvironmentVulnerabilityObjectModel>
    ),
    jobs: PropTypes.objectOf<EnvironmentVulnerabilityObjectModel>(
      PropTypes.shape(
        EnvironmentVulnerabilityObjectModelValidationMap
      ) as PropTypes.Requireable<EnvironmentVulnerabilityObjectModel>
    ),
  };
