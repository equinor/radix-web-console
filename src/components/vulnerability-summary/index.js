import { List, Tooltip } from '@equinor/eds-core-react';
import * as PropTypes from 'prop-types';

import { VulnerabilitySummaryModelValidationMap } from '../../models/vulnerability-summary';

import './style.css';

const VulnerabilityItem = (severity, vulnerabilitySummary) => {
  const severityCount = vulnerabilitySummary[severity] || 0;
  const classSeverity = severityCount === 0 ? 'none' : severity;
  const abbrTitle = `${severity} severity issues`;
  const abbrLabel = severity.substring(0, 1).toUpperCase();

  return (
    <List.Item
      key={severity}
      className={`severity-summary__item severity-summary__item--${classSeverity}`}
    >
      <div className="severity-summary__count">
        <span className="severity-summary__label">{severityCount}</span>
      </div>
      <Tooltip placement="top" title={abbrTitle}>
        <div className="severity-summary__text">
          <span className="severity-summary__label">{abbrLabel}</span>
        </div>
      </Tooltip>
    </List.Item>
  );
};

const VulnerabilitySummary = ({ vulnerabilitySummary }) => {
  return (
    <List className="severity-summary">
      {VulnerabilityItem('critical', vulnerabilitySummary)}
      {VulnerabilityItem('high', vulnerabilitySummary)}
      {VulnerabilityItem('medium', vulnerabilitySummary)}
      {VulnerabilityItem('low', vulnerabilitySummary)}
      {vulnerabilitySummary.unknown &&
        VulnerabilityItem('unknown', vulnerabilitySummary)}
    </List>
  );
};

VulnerabilitySummary.propTypes = {
  vulnerabilitySummary: PropTypes.shape(VulnerabilitySummaryModelValidationMap)
    .isRequired,
};

export default VulnerabilitySummary;
