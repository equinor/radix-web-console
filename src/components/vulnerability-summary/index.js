import PropTypes from 'prop-types';
import React from 'react';
import classnames from 'classnames';

import VulnerabilitySummaryModel from '../../models/vulnerability-summary';
import './style.css';

const VulnerabilityItem = (severity, vulnerabilitySummary) => {
  const severityCount = vulnerabilitySummary[severity] || 0;
  const classSeverity = severityCount === 0 ? 'none' : severity;
  const abbrTitle = severity + ' severity issues';
  const abbrLabel = severity.substring(0, 1).toUpperCase();

  return (
    <li
      key={severity}
      className={classnames(
        'severity-summary__item',
        'severity-summary__item--' + classSeverity
      )}
    >
      <div className="severity-summary__count">
        <span className="severity-summary__label">{severityCount || 0}</span>
      </div>
      <div className="severity-summary__text" title={abbrTitle}>
        <span className="severity-summary__label">{abbrLabel}</span>
      </div>
    </li>
  );
};

const VulnerabilitySummary = ({ vulnerabilitySummary }) => {
  return (
    <ul className="severity-summary">
      {VulnerabilityItem('critical', vulnerabilitySummary)}
      {VulnerabilityItem('high', vulnerabilitySummary)}
      {VulnerabilityItem('medium', vulnerabilitySummary)}
      {VulnerabilityItem('low', vulnerabilitySummary)}
      {vulnerabilitySummary.unknown &&
        VulnerabilityItem('unknown', vulnerabilitySummary)}
    </ul>
  );
};

VulnerabilitySummary.propTypes = {
  vulnerabilitySummary: PropTypes.exact(VulnerabilitySummaryModel).isRequired,
};

export default VulnerabilitySummary;
